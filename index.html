<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ğŸš˜ Beta Games â€“ Crazy Cars 3D</title>
<style>
body { margin:0; overflow:hidden; background:black; font-family:Arial; }
#ui {
 position:absolute;
 top:10px; left:10px;
 color:white;
 z-index:10;
 background:rgba(0,0,0,0.6);
 padding:10px;
 border-radius:10px;
}
button { font-size:16px; margin:2px; cursor:pointer; }
</style>
</head>
<body>

<div id="ui">
ğŸš— Select Car:
<button onclick="selectCar('ğŸš—')">ğŸš—</button>
<button onclick="selectCar('ğŸš•')">ğŸš•</button>
<button onclick="selectCar('ğŸš™')">ğŸš™</button>
<button onclick="selectCar('ğŸš')">ğŸš</button>
<button onclick="selectCar('ğŸšš')">ğŸšš</button>
<button onclick="selectCar('ğŸšœ')">ğŸšœ</button>
<br><br>
ğŸ® Controls: WASD / Arrow Keys  
<br>ğŸš“ Survive police for 30 seconds!
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.157/build/three.min.js"></script>

<script>
let scene, camera, renderer;
let car, carEmoji="ğŸš—";
let speed=0, turn=0;
let policeCars=[];
let chaseTimer=0;
let policeActive=false;

init();
animate();

function init(){
 scene = new THREE.Scene();
 scene.background = new THREE.Color(0x87ceeb);

 camera = new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
 camera.position.set(0,6,10);

 renderer = new THREE.WebGLRenderer({antialias:true});
 renderer.setSize(window.innerWidth,window.innerHeight);
 document.body.appendChild(renderer.domElement);

 // Lights
 scene.add(new THREE.AmbientLight(0xffffff,0.5));
 const sun = new THREE.DirectionalLight(0xffffff,1);
 sun.position.set(10,20,10);
 scene.add(sun);

 // Ground
 const ground = new THREE.Mesh(
   new THREE.PlaneGeometry(500,500),
   new THREE.MeshStandardMaterial({color:0x444444})
 );
 ground.rotation.x = -Math.PI/2;
 scene.add(ground);

 createCity();
 createCar();
 spawnPolice();

 window.addEventListener("resize", ()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
 });
}

function createCity(){
 for(let i=0;i<40;i++){
   const h = Math.random()*20+5;
   const building = new THREE.Mesh(
     new THREE.BoxGeometry(5,h,5),
     new THREE.MeshStandardMaterial({color:0x666666})
   );
   building.position.set(
     (Math.random()-0.5)*200,
     h/2,
     (Math.random()-0.5)*200
   );
   scene.add(building);
 }
}

function createCar(){
 const geo = new THREE.BoxGeometry(2,1,4);
 const mat = new THREE.MeshStandardMaterial({color:0xff0000});
 car = new THREE.Mesh(geo,mat);
 car.position.y=0.5;
 scene.add(car);
}

function selectCar(emoji){
 carEmoji = emoji;
 alert("Selected car: "+emoji);
}

function spawnPolice(){
 policeCars=[];
 let count = Math.floor(Math.random()*4)+1;

 for(let i=0;i<count;i++){
  const p = new THREE.Mesh(
    new THREE.BoxGeometry(2,1,4),
    new THREE.MeshStandardMaterial({color:0x0000ff})
  );
  p.position.set((Math.random()-0.5)*80,0.5,(Math.random()-0.5)*80);
  scene.add(p);
  policeCars.push(p);
 }

 chaseTimer = 0;
 policeActive=true;
}

document.addEventListener("keydown",e=>{
 if(e.key=="ArrowUp"||e.key=="w") speed=0.5;
 if(e.key=="ArrowDown"||e.key=="s") speed=-0.3;
 if(e.key=="ArrowLeft"||e.key=="a") turn=0.05;
 if(e.key=="ArrowRight"||e.key=="d") turn=-0.05;
});
document.addEventListener("keyup",()=>{speed=0;turn=0;});

function animate(){
 requestAnimationFrame(animate);

 car.rotation.y += turn;
 car.translateZ(speed);

 // Camera follow
 camera.position.lerp(
   new THREE.Vector3(
     car.position.x+Math.sin(car.rotation.y)*10,
     6,
     car.position.z+Math.cos(car.rotation.y)*10
   ),0.1
 );
 camera.lookAt(car.position);

 updatePolice();

 renderer.render(scene,camera);
}

function updatePolice(){
 if(!policeActive) return;

 chaseTimer += 0.016;

 policeCars.forEach(p=>{
   const dir = new THREE.Vector3().subVectors(car.position,p.position).normalize();
   p.position.add(dir.multiplyScalar(0.15));
   p.lookAt(car.position);

   // Collision
   if(p.position.distanceTo(car.position)<2){
     alert("ğŸš“ You got caught! Restarting...");
     location.reload();
   }
 });

 // Police leave after 30 seconds
 if(chaseTimer>30){
   policeCars.forEach(p=>scene.remove(p));
   policeCars=[];
   policeActive=false;

   setTimeout(spawnPolice,5000); // respawn later
 }
}
</script>
</body>
</html>
